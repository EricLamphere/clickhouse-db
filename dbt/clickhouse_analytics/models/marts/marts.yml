version: 2

models:
  - name: fct_orders
    description: Fact table containing all order transactions with customer and product metrics
    columns:
      - name: order_id
        description: Unique identifier for each order
        tests:
          - unique
          - not_null
      - name: customer_id
        description: Foreign key to dim_customers
        tests:
          - not_null
      - name: total_revenue
        description: Total revenue from the order
      - name: total_profit
        description: Total profit from the order
      - name: profit_margin_pct
        description: Profit margin as a percentage

  - name: dim_customers
    description: Customer dimension with lifetime metrics and segmentation
    columns:
      - name: customer_id
        description: Unique identifier for each customer
        tests:
          - unique
          - not_null
      - name: lifetime_value
        description: Total revenue from completed orders
        tests:
          - not_null
      - name: is_high_value_customer
        description: Flag indicating customers with lifetime value above threshold

  - name: dim_products
    description: Product dimension with sales metrics
    columns:
      - name: product_id
        description: Unique identifier for each product
        tests:
          - unique
          - not_null
      - name: total_revenue
        description: Total revenue generated by this product
      - name: realized_profit_margin_pct
        description: Actual profit margin based on sales data

  - name: daily_sales_summary
    description: Daily aggregated sales metrics
    columns:
      - name: sales_date
        description: Date of sales
        tests:
          - unique
          - not_null
      - name: total_revenue
        description: Total revenue for the day
      - name: profit_margin_pct
        description: Overall profit margin for the day
