Most of this copied from https://github.com/ClickHouse/examples/tree/main/docker-compose-recipes/recipes/ch-and-postgres

However, a lot of helpful information about how this all works here: https://github.com/ClickHouse/ClickHouse/tree/master/docker/server#how-to-extend-this-image